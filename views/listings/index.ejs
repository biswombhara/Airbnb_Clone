<%- layout("/layouts/boiler.ejs") %>
<style>
  
</style>

  
  
  <body>
    <div class="row list row-cols-lg-4 row-cols-md-2 row-cols-sm-1">
      <% let count = 0; %>
        <% for(let listing of allListings){ %>
          <% if( (listing.filter == type) || 
          (listing.country == type) || 
          (listing.title == type) ) {%>
            <a href="/listings/<%= listing._id %>">
              <div class="card col card-listing" >
                  <img src="<%= listing.image.url %>"  class="card-img-top" alt="...">
                  <div class="card-img-overlay">
                    
                  </div>
                  <div class="card-body ms-1">
                    <p class="card-text">
                      <b><%= listing.title %></b>
                      <br>
                      <% if(listing.reviews.length > 0) {%>
                          <% let sum=0; %>
                          <% for(review of listing.reviews) {%>
                            <% sum = sum + review.rating; %>
                          <% } %>
                          <i class="fa-solid fa-star"></i>
                          <%= sum/listing.reviews.length %>
                      <% } %>
                      <br>
                      <%= listing.description %> <br>
                      <span class="listing_price"><b>&#8377;  
                        <%= Number(listing.price).toLocaleString("en-IN") %> </b> night
                      </span>
                      <span class="tax-info"><b>&#8377;  <%listing.price=listing.price+(listing.price*0.18);%>
                        <%=Number(listing.price).toLocaleString("en-IN")%> </b> night
                        <i> +18% GST</i>
                      </span>
                    </p>
                  </div>
              </div>
            </a>          
            <% count+=1; %>
          <% } %>
        <% } %>
        <% for(let listing of allListings){ %>
          <% if( count === 0 ){%>
            <a href="/listings/<%= listing._id %>">
              <div class="card col card-listing" >
                  <img src="<%= listing.image.url %>"  class="card-img-top" alt="...">
                  <div class="card-img-overlay">
                    
                  </div>
                  <div class="card-body ms-1">
                    <p class="card-text">
                      <b><%= listing.title %></b>
                      <br>
                      <% if(listing.reviews.length > 0) {%>
                          <% let sum=0; %>
                          <% for(review of listing.reviews) {%>
                            <% sum = sum + review.rating; %>
                          <% } %>
                          <i class="fa-solid fa-star"></i>
                          <%= sum/listing.reviews.length %>
                      <% } %>
                      <br>
                      <%= listing.description %> <br>
                      <span class="listing_price"><b>&#8377;  
                        <%= Number(listing.price).toLocaleString("en-IN") %> </b> night
                      </span>
                      <span class="tax-info"><b>&#8377;  <%listing.price=listing.price+(listing.price*0.18);%>
                        <%=Number(listing.price).toLocaleString("en-IN")%> </b> night
                        <i> +18% GST</i>
                      </span>
                    </p>
                  </div>
              </div>
            </a>
            <% } %>
          <% } %>
      
    </div>
    <script>
      
    </script>
</body>